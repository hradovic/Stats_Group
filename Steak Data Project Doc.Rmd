---
title: "Steak Data Project Doc"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message = FALSE}
library(tidyverse)
library(fivethirtyeight)
library(dplyr)
library(moderndive)
library(broom)
```

```{r}
steak_survey <-
  steak_survey %>% 
  mutate(age = fct_relevel(as.character(age), "> 60", after = Inf),
         hhold_income = fct_relevel(as.character(hhold_income),
                                     "$0 - $24,999",
                                     "$25,000 - $49,999",
                                     "$50,000 - $99,999"),
         steak_prep_rare = ifelse(steak_prep %in% c("Rare", "Medium rare"),
                                    1, 0)) %>% 
  drop_na(steak_prep)
```

Response Variable: steak_prep

Predictor Variables: Region of US, Household Income, Gambling, Age

Interaction Effects Between: 
Age + Income
Gambling + Income
Region + Income
Region + Age


Question: Which factors most influence people to choose rare or medium rare steak over medium and well-done?

Here are some exploratory graphs:

```{r}
steak_survey %>% 
  ggplot() + 
  geom_bar(aes(x = steak_prep_rare, fill = steak_prep)) +
  facet_wrap(~region) +
  theme_minimal()
```

```{r}
steak_survey %>% 
  ggplot() + 
  geom_bar(aes(x = steak_prep_rare, fill = steak_prep_rare), )+
  facet_wrap(~hhold_income) +
  theme_minimal()
```



```{r}
glm_ageincome <- glm(steak_prep ~ age + hhold_income, data = steak_survey, family = binomial(link = "logit"))
tidy(glm_ageincome)
```

From this model, the predicted odds that a person age 18-29 with income under \$25000 prefers rare steak is $e^{2.93104} = 18.74712$, or about a 95% probability. 


```{r}
glm_incomegamble <- glm(steak_prep_rare ~ gamble + hhold_income, data = steak_survey, family = binomial(link = "logit"))
tidy(glm_incomegamble)
```

The predicted odds that a person who does not gamble and has income under \$25000 prefers rare steak is $e^{-0.4828039} = 0.617$, or about a 38% probability.

```{r}
glm_incomegamble %>%
  ggplot() +
  geom_bar(mapping = aes(x = steak_prep_rare, fill = hhold_income), position = "fill")+
  facet_wrap(~gamble)
```


```{r}
glm_regincome <- glm(steak_prep_rare ~ region + hhold_income, data = steak_survey, family = binomial(link = "logit"))
tidy(glm_regincome)
```

The predicted odds that a person from the east north central region with income under \$25000 prefers rare steak is $e^{-0.5599075}= 0.5712619$, or about a 36% probability.

```{r}
glm_regage <- glm(steak_prep_rare ~ region + age, data = steak_survey)
tidy(glm_regage)
```

The predicted odds that a person from the east north central region from age 18-29 prefers rare steak is $e^{0.340476}=1.405617$, or about a 58% probability.

```{r}
glm_regage %>% 
  ggplot(aes(x = age, y = steak_prep, color = region)) +
  geom_jitter()
```


