---
title: "Steak Data Project Doc"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message = FALSE}
library(tidyverse)
library(fivethirtyeight)
library(dplyr)
library(moderndive)
library(broom)
```

```{r}
steak_survey <-
  steak_survey %>% 
  mutate(age = fct_relevel(as.character(age), "> 60", after = Inf),
         hhold_income = fct_relevel(as.character(hhold_income),
                                     "$0 - $24,999",
                                     "$25,000 - $49,999",
                                     "$50,000 - $99,999"),
         steak_prep_rare = ifelse(steak_prep %in% c("Rare", "Medium rare"),
                                    1, 0)) %>% 
  drop_na(steak_prep)
```

# Description of Data

![bessy!](https://www.plantbasednews.org/.image/t_share/MTY1NTk1NTY0Nzk5NTAyMTE3/image-placeholder-title.jpg)

Steak_survey is a survey of 432 steak eaters in the US. It originally came from a surveymonkey audience poll, an online polling company. 

In this data, we are going to be looking for influences that lead to type of steak consumed. We're interested in looking at this data because we want to see how big a role demographic factors play in the type of food consumed in the US, and if there is more status associated with some methods of cooking steak versus others. Also, we want to see if more risk prone people are more willing to eat rare cooked steak, as this carries the potential for food borne illnesses. 

Response Variable: steak_prep

Predictor Variables: Region of US, Household Income, Gambling, Age

Models based on: 
Income
Gambling
Region + Income
Region + Age


Question: Which factors most influence people to choose rare or medium rare steak over medium and well-done?

Hypothesis: We hypothesize that wealthier people are more likely to consume rare steak than poorer people because rare steak is seen as a status symbol and is offered in a lot of higher-class restaurants. Additionally, we hypothesize that people who are more prone to risk-taking will be more likely to consume rare steak. 

# Exploratory graphs and general overview of data:

The following graph gives an overview of how many people eat each type of steak in the US. 
```{r}
steak_survey %>% 
  ggplot() + 
  geom_bar(aes(x = steak_prep, fill = steak_prep) )
```


This following graph shows the types of steaks consumed by location. From these graphs, there doesn't appear to be a clear pattern in terms of geographic region. 
```{r}
steak_survey %>% 
  ggplot() + 
  geom_bar(aes(x = steak_prep_rare, fill = steak_prep)) +
  facet_wrap(~region) +
  theme_minimal()
```


The following graph shows the relationship between type of steak and income. Again, there isn't a super clear pattern here. Almost all income brackets prefer medium-well over rare and medium-rare. However, medium-rare is by far the most popular category in most of the income brackets... except for the wealthiest group which comes as a surprise to us and counters our original hypothesis. 
```{r}
steak_survey %>% 
  ggplot() + 
  geom_bar(aes(x = steak_prep_rare, fill = steak_prep), )+
  facet_wrap(~hhold_income) +
  theme_minimal()
```






# Logistic Regression Models

**Model based on income**

```{r}
glm_income <- glm(steak_prep_rare ~ hhold_income, data = steak_survey, family = binomial(link = "logit")) 

tidy(glm_income) %>%
  mutate(exp.est = exp(estimate))
```
From this model, the predicted odds that a person age 18-29 prefers rare steak is $e^{-0.5798185}=0.56$, or a probability of about 35.9%. These odds are multiplied by approximately 1.73 for both the \$25,000-49,999 and 100,000-149,999 income brackets. However, for those with incomes over \$150,000, the odds are decreased by a factor of 0.829. This indicates that the model predicts that the wealthiest people are actually less likely to prefer rare steak than the least wealthy.

**Model based on gambling**
```{r}
glm_gamble <- glm(steak_prep_rare ~ gamble, data = steak_survey, family = binomial(link = "logit"))

tidy(glm_gamble)%>%
mutate(exp.est = exp(estimate))
```
The predicted odds that a person who does not gamble prefers rare steak is $e^{-0.19782574}=0.8205128$, or about a 45% probability. If the person gambles, these odds are multiplied by 0.9214939. This implies that a person who enjoys gambling actually has lower odds of preferring rare steak.

$H_0: \beta_{gambleTRUE} = 0$

$H_a: \beta_{gambleTRUE} \neq 0$

The p value for gambleTRUE is 0.6742880. This indicates that, assuming the null hypothesis were true and gambling had no effect on steak preference, there would be a 67.4% chance of getting a coefficient as extreme as -0.08175911. This p value is much larger than 0.05, so we cannot reject the null hypothesis.

**Model Based on region and income**

```{r}
glm_regincome <- glm(steak_prep_rare ~ region + hhold_income, data = steak_survey, family = binomial(link = "logit"))

tidy(glm_regincome) %>%
  mutate(exp.est = (exp(estimate)))
```
The predicted odds that a person from the east north central region with income under \$25,000 prefers rare steak is $e^{-0.55990752}=0.5712619$, or about a 36% probability. The mountain region is the least likely to prefer steak, at only an 18.56% probability according to the model. Although we are now accounting for region, the effect of income on the odds is very similar to how it was in the model that used only income.

**Model based on region and age**

```{r}
glm_regage <- glm(steak_prep_rare ~ region + age, data = steak_survey, family = binomial(link = "logit"))

tidy(glm_regage) %>%
  mutate(exp.est = exp(estimate))
```
The predicted odds that a person from the east north central region from age 18-29 prefers rare steak is $e^{-0.6588634}=0.5174391$, or about a 34% probability. Accounting for age, a person from the west south central region is most likely to prefer rare steak, as this region has the highest exponentiated coefficient of 1.9196. Also, as age increases, the odds of preferring rare steak consistently increase as well when region is held constant.


![Steak!](https://www.tasteofhome.com/wp-content/uploads/2019/01/medium-rare-steak-shutterstock_706040446-800x450.jpg)


# Hypothesis Testing
```{r}
completeFun <- function(data, desiredCols) {  #This function removes rows of data that have NA in given columns
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}

steak_survey_income_NArm <- completeFun(steak_survey, "hhold_income")
anova(glm(steak_prep_rare ~ 1, data = steak_survey_income_NArm, family = binomial(link = "logit")), glm_income) %>%
  tidy()
```


# Conclusion






Next Steps:








